<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Macros + History</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Food">
  <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body>


  <div class="chartSection">
    <div class="chartHeader">
        
        <div class="row"><div class="rangeControls">
        
        
        
          <div>
            <div class="row inline">
              <label for="historyStart">Start</label>
              <input id="historyStart" type="date">
            </div>
            <div class="row inline">
              <label for="historyEnd">End</label>
              <input id="historyEnd" type="date">
            </div>
          </div>
          <div class="historyFile">
            <label for="importHistoryFile" class="file-btn">Import History</label>
            <input id="importHistoryFile" type="file" accept="application/json,.json" style="display: none;">
            <label for="importFoodsFile" class="file-btn">Import Foods</label>
            <input id="importFoodsFile" type="file" accept="application/json,.json" style="display: none;">
            <button id="exportDataBtn">Download Data</button>
          </div>
        </div>

    <div class="canvasWrap">
        <canvas id="historyChart" style="display: block; box-sizing: border-box; height: 358px; width: 340px;" width="340" height="358"></canvas>
    </div>
    </div><!-- MACRO CALCULATOR CARD -->
  <button id="openFoodEditorBtn" type="button">Add new food</button>
  <div id="foodModalBackdrop" class="modal-backdrop hidden"></div>
  <div id="foodModal" class="modal hidden" role="dialog">
    <div class="modal-header">
      <h2>Add a New Food</h2>
      <button id="closeFoodModalBtn" class="modal-close" type="button">Close</button>
      <button id="saveFoodModalBtn" class="modal-save" type="button">Save</button>
    </div>
    <form id="foodForm" class="modal-body">
      <label>
        Name
        <input id="newFoodName" type="text" required></input>
      </label>

      <label>
        Base Unit
        <select id="newFoodBaseUnit" required>
          <option value="g">grams</option>
          <option value="ml">milliliters</option>
        </select>
      </label>

      <label>
        Serving Size (in base unit)
        <input id="newFoodServingSize" type="number" min="0.0001" step="0.01" required></input>
      </label>

      <label>
        Calories per serving
        <input id="newFoodCals" type="number" min="0" step="1" placeholder="e.g., 120" required />
      </label>

      <label>
        Protein
        <input id="newFoodProtein" type="number" min="0" step="0.1" required></input>
      </label>

      <label>
        Fat
        <input id="newFoodFat" type="number" min="0" step="0.1" required></input>
      </label>

      <label>
        Carbs
        <input id="newFoodCarbs" type="number" min="0" step="0.1" required></input>
      </label>
    </form>
  </div>
  <div class="card">
    <h1>Macro Calculator</h1>

    <div class="panel"><div class="panel" style="/*! display: grid; */flex: 1;"><div class="row">
      <label for="foodSelect">Food</label>
      <select id="foodSelect"></select>
    </div><div class="row">
      <label for="measureSelect">Measure</label>
      <select id="measureSelect"></select>
    </div><div class="row">
      <label for="amountInput">Amount (<span id="unitLabel">g</span>)</label>
      <input id="amountInput" type="number" inputmode="decimal" min="0" step="0.1" placeholder="Enter grams…">
    </div><div class="actions">
      <button id="addBtn">Add to Today’s Intake</button>
      
    </div><div></div></div><div id="preview" class="result">
      <h2>This Entry</h2>
      <table>
        <tbody>
          <tr><td>Calories</td><td><strong id="pKcal">0</strong> kcal</td></tr>
          <tr><td>Protein</td><td><strong id="pProtein">0</strong> g</td><td id="pProteinRatio">0%</td></tr>
          <tr><td>Fat</td><td><strong id="pFat">0</strong> g</td><td id="pFatRatio">0%</td></tr>
          <tr><td>Carbs</td><td><strong id="pCarbs">0</strong> g</td><td id="pCarbRatio">0%</td></tr>
        </tbody>
      </table>
      <div class="hint" id="perUnitHint"></div>
    </div></div>
    

    <div class="log">
      <div class="logHeader">
        <h2>Intake</h2>
        
      </div>

      <div class="logTableWrap">
        <table class="logTable">
          <thead>
            <tr>
              <th style="text-align: left;">Item</th>
              <th class="num">Amount</th>
              <th class="num">kcal</th>
              <th class="num">P</th>
              <th class="num">F</th>
              <th class="num">C</th>
              <th style="text-align: right;"></th>
            </tr>
          </thead>
          <tbody id="logBody"><tr><td colspan="7" style="color: var(--muted); padding: 14px 10px;">
        No items yet — add something above.
      </td></tr></tbody>
          <tfoot>
            <tr>
              <td><strong>Total</strong></td>
              <td></td>
              <td class="num"><strong id="tKcal">0</strong></td>
              <td class="num"><strong id="tProtein">0.0</strong></td>
              <td class="num"><strong id="tFat">0.0</strong></td>
              <td class="num"><strong id="tCarbs">0.0</strong></td>
              <td></td>
            </tr>
          </tfoot>
          <tfoot>
            <tr>
              <td><strong>Ratios</strong></td>
              <td></td>
              <td class="num" id="tKcalRatio"></td>
              <td class="num" id="tProteinRatio">0.0%</td>
              <td class="num" id="tFatRatio">0.0%</td>
              <td class="num" id="tCarbsRatio">0.0%</td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>

      
    <button id="clearLogBtn" class="secondary small">Clear Intake</button></div>

    <div class="panel">
        
        <div class="row"><label for="saveDayDate">Date</label><input id="saveDayDate" type="date"></div><div class="row"><label for="weightInput">Weight</label><input id="weightInput" type="number" inputmode="decimal" step="0.1" placeholder="e.g. 203.0"></div><div class="row"><div></div><button id="saveDayBtn">Save Day (from Today’s Intake)</button></div>
        
        
        </div><div class="hint subtle" id="saveDayMsg">Saved 2026-01-09</div><p class="footer">
      Edit <code>foods.js</code> to add/adjust foods/measures.
    </p>
  </div><script src="./foods.js"></script>
  <!-- Chart.js from node_modules (UMD build) -->
  <!-- <script src="./node_modules/chart.js/dist/chart.umd.js"></script> -->
  <script src="./app.js"></script>
  <!-- <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
  </script> -->



</body>
</html>
